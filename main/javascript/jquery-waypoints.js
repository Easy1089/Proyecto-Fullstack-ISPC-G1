(function(){var b=[].indexOf||function(f){for(var c=0,d=this.length;c<d;c++){if(c in this&&this[c]===f){return c}}return -1},a=[].slice;(function(d,c){if(typeof define==="function"&&define.amd){return define("waypoints",["jquery"],function(e){return c(e,d)})}else{return c(d.jQuery,d)}})(this,function(C,F){var z,D,A,G,q,H,j,e,x,k,E,K,I,J,t,B;z=C(F);e=b.call(F,"ontouchstart")>=0;G={horizontal:{},vertical:{}};q=1;j={};H="waypoints-context-id";E="resize.waypoints";K="scroll.waypoints";I=1;J="waypoints-waypoint-ids";t="waypoint";B="waypoints";D=function(){function c(f){var d=this;this.$element=f;this.element=f[0];this.didResize=false;this.didScroll=false;this.id="context"+q++;this.oldScroll={x:f.scrollLeft(),y:f.scrollTop()};this.waypoints={horizontal:{},vertical:{}};this.element[H]=this.id;j[this.id]=this;f.bind(K,function(){var g;if(!(d.didScroll||e)){d.didScroll=true;g=function(){d.doScroll();return d.didScroll=false};return F.setTimeout(g,C[B].settings.scrollThrottle)}});f.bind(E,function(){var g;if(!d.didResize){d.didResize=true;g=function(){C[B]("refresh");return d.didResize=false};return F.setTimeout(g,C[B].settings.resizeThrottle)}})}c.prototype.doScroll=function(){var f,d=this;f={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};if(e&&(!f.vertical.oldScroll||!f.vertical.newScroll)){C[B]("refresh")}C.each(f,function(p,n){var g,m,h;h=[];m=n.newScroll>n.oldScroll;g=m?n.forward:n.backward;C.each(d.waypoints[p],function(s,l){var r,o;if(n.oldScroll<(r=l.offset)&&r<=n.newScroll){return h.push(l)}else{if(n.newScroll<(o=l.offset)&&o<=n.oldScroll){return h.push(l)}}});h.sort(function(l,i){return l.offset-i.offset});if(!m){h.reverse()}return C.each(h,function(l,i){if(i.options.continuous||l===h.length-1){return i.trigger([g])}})});return this.oldScroll={x:f.horizontal.newScroll,y:f.vertical.newScroll}};c.prototype.refresh=function(){var h,d,g,f=this;g=C.isWindow(this.element);d=this.$element.offset();this.doScroll();h={horizontal:{contextOffset:g?0:d.left,contextScroll:g?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:g?0:d.top,contextScroll:g?0:this.oldScroll.y,contextDimension:g?C[B]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};return C.each(h,function(l,i){return C.each(f.waypoints[l],function(y,v){var n,u,p,w,m;n=v.options.offset;p=v.offset;u=C.isWindow(v.element)?0:v.$element.offset()[i.offsetProp];if(C.isFunction(n)){n=n.apply(v.element)}else{if(typeof n==="string"){n=parseFloat(n);if(v.options.offset.indexOf("%")>-1){n=Math.ceil(i.contextDimension*n/100)}}}v.offset=u-i.contextOffset+i.contextScroll-n;if(v.options.onlyOnScroll&&p!=null||!v.enabled){return}if(p!==null&&p<(w=i.oldScroll)&&w<=v.offset){return v.trigger([i.backward])}else{if(p!==null&&p>(m=i.oldScroll)&&m>=v.offset){return v.trigger([i.forward])}else{if(p===null&&i.oldScroll>=v.offset){return v.trigger([i.forward])}}}})})};c.prototype.checkEmpty=function(){if(C.isEmptyObject(this.waypoints.horizontal)&&C.isEmptyObject(this.waypoints.vertical)){this.$element.unbind([E,K].join(" "));return delete j[this.id]}};return c}();A=function(){function c(l,d,h){var f,g;h=C.extend({},C.fn[t].defaults,h);if(h.offset==="bottom-in-view"){h.offset=function(){var i;i=C[B]("viewportHeight");if(!C.isWindow(d.element)){i=d.$element.height()}return i-C(this).outerHeight()}}this.$element=l;this.element=l[0];this.axis=h.horizontal?"horizontal":"vertical";this.callback=h.handler;this.context=d;this.enabled=h.enabled;this.id="waypoints"+I++;this.offset=null;this.options=h;d.waypoints[this.axis][this.id]=this;G[this.axis][this.id]=this;f=(g=this.element[J])!=null?g:[];f.push(this.id);this.element[J]=f}c.prototype.trigger=function(d){if(!this.enabled){return}if(this.callback!=null){this.callback.apply(this.element,d)}if(this.options.triggerOnce){return this.destroy()}};c.prototype.disable=function(){return this.enabled=false};c.prototype.enable=function(){this.context.refresh();return this.enabled=true};c.prototype.destroy=function(){delete G[this.axis][this.id];delete this.context.waypoints[this.axis][this.id];return this.context.checkEmpty()};c.getWaypointsByElement=function(g){var d,f;f=g[J];if(!f){return[]}d=C.extend({},G.horizontal,G.vertical);return C.map(f,function(h){return d[h]})};return c}();k={init:function(f,c){var d;if(c==null){c={}}if((d=c.handler)==null){c.handler=f}this.each(function(){var m,h,g,l;m=C(this);g=(l=c.context)!=null?l:C.fn[t].defaults.context;if(!C.isWindow(g)){g=m.closest(g)}g=C(g);h=j[g[0][H]];if(!h){h=new D(g)}return new A(m,h,c)});C[B]("refresh");return this},disable:function(){return k._invoke.call(this,"disable")},enable:function(){return k._invoke.call(this,"enable")},destroy:function(){return k._invoke.call(this,"destroy")},prev:function(d,c){return k._traverse.call(this,d,c,function(h,f,g){if(f>0){return h.push(g[f-1])}})},next:function(d,c){return k._traverse.call(this,d,c,function(h,f,g){if(f<g.length-1){return h.push(g[f+1])}})},_traverse:function(h,c,d){var g,f;if(h==null){h="vertical"}if(c==null){c=F}f=x.aggregate(c);g=[];this.each(function(){var i;i=C.inArray(this,f[h]);return d(g,i,f[h])});return this.pushStack(g)},_invoke:function(c){this.each(function(){var d;d=A.getWaypointsByElement(this);return C.each(d,function(f,g){g[c]();return true})});return this}};C.fn[t]=function(){var d,c;c=arguments[0],d=2<=arguments.length?a.call(arguments,1):[];if(k[c]){return k[c].apply(this,d)}else{if(C.isFunction(c)){return k.init.apply(this,arguments)}else{if(C.isPlainObject(c)){return k.init.apply(this,[null,c])}else{if(!c){return C.error("jQuery Waypoints needs a callback function or handler option.")}else{return C.error("The "+c+" method does not exist in jQuery Waypoints.")}}}}};C.fn[t].defaults={context:F,continuous:true,enabled:true,horizontal:false,offset:0,triggerOnce:false};x={refresh:function(){return C.each(j,function(d,c){return c.refresh()})},viewportHeight:function(){var c;return(c=F.innerHeight)!=null?c:z.height()},aggregate:function(g){var c,f,d;c=G;if(g){c=(d=j[C(g)[0][H]])!=null?d.waypoints:void 0}if(!c){return[]}f={horizontal:[],vertical:[]};C.each(f,function(l,h){C.each(c[l],function(m,i){return h.push(i)});h.sort(function(m,i){return m.offset-i.offset});f[l]=C.map(h,function(i){return i.element});return f[l]=C.unique(f[l])});return f},above:function(c){if(c==null){c=F}return x._filter(c,"vertical",function(f,d){return d.offset<=f.oldScroll.y})},below:function(c){if(c==null){c=F}return x._filter(c,"vertical",function(f,d){return d.offset>f.oldScroll.y})},left:function(c){if(c==null){c=F}return x._filter(c,"horizontal",function(f,d){return d.offset<=f.oldScroll.x})},right:function(c){if(c==null){c=F}return x._filter(c,"horizontal",function(f,d){return d.offset>f.oldScroll.x})},enable:function(){return x._invoke("enable")},disable:function(){return x._invoke("disable")},destroy:function(){return x._invoke("destroy")},extendFn:function(d,c){return k[d]=c},_invoke:function(d){var c;c=C.extend({},G.vertical,G.horizontal);return C.each(c,function(f,g){g[d]();return true})},_filter:function(h,c,g){var d,f;d=j[C(h)[0][H]];if(!d){return[]}f=[];C.each(d.waypoints[c],function(l,i){if(g(d,i)){return f.push(i)}});f.sort(function(l,i){return l.offset-i.offset});return C.map(f,function(i){return i.element})}};C[B]=function(){var d,c;c=arguments[0],d=2<=arguments.length?a.call(arguments,1):[];if(x[c]){return x[c].apply(null,d)}else{return x.aggregate.call(null,c)}};C[B].settings={resizeThrottle:100,scrollThrottle:30};return z.load(function(){return C[B]("refresh")})})}).call(this);